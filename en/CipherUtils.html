<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="icon" href="https://qiniuoss.xuyijie.icu/SecureApiDoc/img/logo/favicon.png"><title>CipherUtils | SecureApi Document</title><meta name="description" content="A spring boot interface parameters and return value encryption and decryption tool">
    <link rel="preload" href="/secure-api-doc/assets/style-BDZmSSuf.css" as="style"><link rel="stylesheet" href="/secure-api-doc/assets/style-BDZmSSuf.css">
    <link rel="modulepreload" href="/secure-api-doc/assets/app-k7d3ULAd.js"><link rel="modulepreload" href="/secure-api-doc/assets/CipherUtils.html-CzZEwZu7.js">
    <link rel="prefetch" href="/secure-api-doc/assets/CipherUtils.html-BSBvxyMj.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/DH密钥协商.html-Bhoi6UWy.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/index.html-IBwd47K1.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/URL匹配.html-De6LN8f-.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/两种模式.html-CqJ89RTo.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/加密算法.html-D4NpwCK4.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/安装.html-l_XBVyQ8.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/开始使用.html-cCiteQ2q.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/异常处理.html-Cpp2sQGP.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/注解.html-DfmV3Vxh.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/版本历史.html-BpQgSCnV.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/试一下.html-Bn-KIdHg.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/配置.html-Ct84Ag8G.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/DH-key-agreement.html-LuRNTry5.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/index.html-ClWpE7pP.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/annotation.html-BaD3wVkF.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/configuration.html-BpnLKH8c.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/encryption-algorithm.html-BrYRSY2U.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/exception-handle.html-Cktpee_J.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/get-started.html-CbJA0n_j.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/install.html-DQTzX1lg.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/try-it.html-CFp8yEY-.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/two-modes.html-Lrq3VHUU.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/url-pattern.html-BhgMmzjN.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/version-history.html-0NXKzFAX.js" as="script"><link rel="prefetch" href="/secure-api-doc/assets/404.html-CkaBVXpD.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/secure-api-doc/en/"><img class="vp-site-logo" src="https://qiniuoss.xuyijie.icu/SecureApiDoc/img/logo/logo.png" alt="SecureApi Document"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">SecureApi Document</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/secure-api-doc/en/" aria-label="Home"><!---->Home<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/secure-api-doc/en/get-started.html" aria-label="Get Start"><!---->Get Start<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/secure-api-doc/en/version-history.html" aria-label="Version History"><!---->Version History<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">切换语言</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">切换语言</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/secure-api-doc/CipherUtils.html" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/secure-api-doc/en/CipherUtils.html" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/BubblingXuYijie/secure-api-spring-boot" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/secure-api-doc/en/" aria-label="Home"><!---->Home<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/secure-api-doc/en/get-started.html" aria-label="Get Start"><!---->Get Start<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/secure-api-doc/en/version-history.html" aria-label="Version History"><!---->Version History<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">切换语言</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">切换语言</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/secure-api-doc/CipherUtils.html" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/secure-api-doc/en/CipherUtils.html" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/BubblingXuYijie/secure-api-spring-boot" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/get-started.html" aria-label="Start"><!---->Start<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/install.html" aria-label="Install"><!---->Install<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/configuration.html" aria-label="Configuration"><!---->Configuration<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/try-it.html" aria-label="Try It"><!---->Try It<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/annotation.html" aria-label="Annotation"><!---->Annotation<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/url-pattern.html" aria-label="Url Pattern"><!---->Url Pattern<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/exception-handle.html" aria-label="Exception Handle"><!---->Exception Handle<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/encryption-algorithm.html" aria-label="Encryption Algorithm"><!---->Encryption Algorithm<!----></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item vp-sidebar-heading active" href="/secure-api-doc/en/CipherUtils.html" aria-label="CipherUtils"><!---->CipherUtils<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/two-modes.html" aria-label="Two Modes"><!---->Two Modes<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/secure-api-doc/en/DH-key-agreement.html" aria-label="DH Key Agreement"><!---->DH Key Agreement<!----></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="cipherutils" tabindex="-1"><a class="header-anchor" href="#cipherutils"><span>CipherUtils</span></a></h1><h2 id="introduce" tabindex="-1"><a class="header-anchor" href="#introduce"><span>Introduce</span></a></h2><p><code>CipherUtils</code> is an encryption and decryption tool class provided by SecureApi. You can use it in your code to achieve more personalized encryption and decryption methods</p><h2 id="start" tabindex="-1"><a class="header-anchor" href="#start"><span>Start</span></a></h2><p>Initialize CipherUtils with the encryption algorithm you want to use</p><blockquote><p>You can use singleton mode to initialize a global use</p></blockquote><blockquote><p>Note that if you register it as a bean, please do not name it cipherUtils. SecureApi has registered a bean named cipherUtils internally, which will cause conflicts. Of course, you can also directly inject cipherUtils provided by SecureApi, but do not inject it in the SecureApi configuration file. At this time, cipherUtils has not been initialized</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token class-name">CipherUtils</span> cipherUtils <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CipherUtils</span><span class="token punctuation">(</span><span class="token class-name">CipherAlgorithmEnum</span><span class="token punctuation">.</span><span class="token constant">AES_CBC_PKCS5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// CipherUtils cipherUtils = new CipherUtils(CipherAlgorithmEnum.RSA_ECB_SHA256);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="symmetric-algorithm" tabindex="-1"><a class="header-anchor" href="#symmetric-algorithm"><span>Symmetric algorithm</span></a></h2><h3 id="generate-key" tabindex="-1"><a class="header-anchor" href="#generate-key"><span>Generate key</span></a></h3><blockquote><p>Above we chose the &quot;AES_CBC_PKCS5&quot; symmetric algorithm, cipherUtils will generate the key of the corresponding algorithm for us, you can specify &quot;seed&quot; to ensure that the same key is generated every time you run it.</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token comment">// Generate key</span></span>
<span class="line"><span class="token class-name">String</span> key <span class="token operator">=</span> cipherUtils<span class="token punctuation">.</span><span class="token function">getRandomSecreteKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// Generate offsets (required for CBC model, not required for ECB mode)</span></span>
<span class="line"><span class="token class-name">String</span> iv <span class="token operator">=</span> cipherUtils<span class="token punctuation">.</span><span class="token function">getRandomIv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="encrypt-and-decrypt" tabindex="-1"><a class="header-anchor" href="#encrypt-and-decrypt"><span>Encrypt and decrypt</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token class-name">String</span> content <span class="token operator">=</span> <span class="token string">&quot;hello,您好！《》\\/&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token class-name">String</span> encryptString <span class="token operator">=</span> cipherUtils<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token class-name">String</span> decryptString <span class="token operator">=</span> cipherUtils<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encryptString<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="asymmetric-algorithm" tabindex="-1"><a class="header-anchor" href="#asymmetric-algorithm"><span>Asymmetric algorithm</span></a></h2><h3 id="generate-key-1" tabindex="-1"><a class="header-anchor" href="#generate-key-1"><span>Generate key</span></a></h3><blockquote><p>If you choose RSA_ECB_SHA256 asymmetric encryption, then we need to generate a key pair</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token comment">// Generate key pairs, RSA asymmetric encryption only has ECB mode, so no offsets are required</span></span>
<span class="line"><span class="token class-name">RsaKeyPair</span> rsaKeyPair <span class="token operator">=</span> cipherUtils<span class="token punctuation">.</span><span class="token function">getRandomRsaKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// For encrypt</span></span>
<span class="line"><span class="token class-name">String</span> publicKey <span class="token operator">=</span> rsaKeyPair<span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// For decrypt</span></span>
<span class="line"><span class="token class-name">String</span> privateKey <span class="token operator">=</span> rsaKeyPair<span class="token punctuation">.</span><span class="token function">getPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="encrypt-and-decrypt-1" tabindex="-1"><a class="header-anchor" href="#encrypt-and-decrypt-1"><span>Encrypt and decrypt</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token class-name">String</span> content <span class="token operator">=</span> <span class="token string">&quot;hello,您好！《》\\/&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token class-name">String</span> encryptString <span class="token operator">=</span> cipherUtils<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token class-name">String</span> decryptString <span class="token operator">=</span> cipherUtils<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encryptString<span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link label" href="https://github.com/BubblingXuYijie/secure-api-doc/edit/main/en/CipherUtils.md" aria-label="Edit this page" rel="noopener noreferrer" target="_blank"><!--[--><svg class="edit-icon" viewbox="0 0 1024 1024"><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->Edit this page<!----></a></div><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1119461672@qq.com">XuYijie</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/secure-api-doc/en/encryption-algorithm.html" aria-label="Encryption Algorithm"><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span>Encryption Algorithm</span></div></a><a class="route-link auto-link next" href="/secure-api-doc/en/two-modes.html" aria-label="Two Modes"><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span>Two Modes</span></div></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/secure-api-doc/assets/app-k7d3ULAd.js" defer></script>
  </body>
</html>
